---
title: "Pr√©sentation de l'application de cartographie th√©matique Magrit üåç"
author:
  name: "Matthieu Viry"
  email: "matthieu.viry@cnrs.fr"
subtitle: "19 D√©cembre 2023 - Universit√© du Sine Saloum El-h√¢dj ibrahima NIASS"
format:
  revealjs:
    embed-resources: false
    slide-number: true
    show-slide-number: all
    chalkboard: true
    logo: images/logos-footer.png
    width: 1150
    height: 740
title-slide-attributes:
  data-background-image: images/logos-footer.png
  data-background-size: 42%
  data-background-position: 50% 90%
css: ['static/style.css']
prefer-html: true
lang: fr
---


# Plan de la s√©ance üìù

<br />

1. Introduction
2. Rappels sur la cartographie th√©matique et les r√®gles de s√©miologie graphique
3. Pr√©sentation de l'application Magrit
4. Exemples d'utilisation de Magrit (d√©monstration)
5. Exercices pratiques / discussion

# Introduction

<center>
<img src="images/Magrit-red-black-description.png">
</center>

# Rappels cartographie th√©matique et s√©miologie graphique

## Histoire de la cartographie th√©matique

- La cartographie th√©matique est une discipline qui a √©merg√© au cours du **XIXe si√®cle**.
- Elle est n√©e de la volont√© de **repr√©senter des donn√©es statistiques sur une carte**.
- Elle a √©t√© d√©velopp√©e par des **statisticiens** et des **g√©ographes**.
- Elle est par exemple utilis√©e pour **√©tudier les ph√©nom√®nes sociaux** (d√©mographie, √©conomie, etc.) et **environnementaux** (climat, g√©ologie, etc.).
- Elle est utilis√©e pour **communiquer** sur ces ph√©nom√®nes et facilier la **prise des d√©cisions**.

## S√©miologie graphique et variables visuelles

- La s√©miologie graphique est une discipline qui a √©t√© d√©velopp√©e par **Jacques Bertin** dans les ann√©es **1960**.
- Elle permet de **choisir les variables visuelles** (couleur, taille, forme, etc.) les plus adapt√©es pour repr√©senter une information.
- Elle permet de **construire des cartes efficaces** (c'est √† dire qui permettent de transmettre l'information de mani√®re claire et pr√©cise) et **esth√©tiques** (c'est √† dire qui permettent de transmettre l'information de mani√®re agr√©able).

## Aux origines de la s√©miologie graphique

<br>

<center>**Le langage cartographique** a √©t√© th√©oris√© par **Jacques Bertin** (1967).</center>

::::{.columns .medium}
::: {.column width="33%"}

![](images/bertin_1.jpg)

:::

::: {.column width="33%"}

<br> *"Si pour obtenir une r√©ponse correcte et compl√®te √† une question donn√©e (...) une construction requiert un temps d'observation plus court qu'une autre construction, on dira qu'elle est plus efficace pour cette question"*

<br> Il d√©veloppe une **grammaire graphique** en lien avec l'information √† repr√©senter (les donn√©es).

:::

::: {.column width="33%"}

![](images/bertin_2.jpg)

:::
::::

## Le support du langage cartographique

<center><img src="images/implantation.png" width="800"/></center>

## Variables visuelles et implantation

::: columns
::: {.column width="50%"}
<img src="images/VV_valeur.png" width="550"/> <img src="images/VV_couleur.png" width="550"/> <img src="images/VV_taille_ordre.png" width="550"/>
:::

::: {.column width="50%"}
<img src="images/VV_harmonique.png" width="550"/> <img src="images/VV_intensite.png" width="550"/> <img src="images/VV_forme.png" width="550"/>
:::
:::

## Variables visuelles et implantation

<br />

<center><img src="images/VV_grain.png" width="550"/> <img src="images/VV_orientation.png" width="550"/> <img src="images/VV_texture_diff.png" width="550"/></center>

## Propri√©t√©s des variables visuelles

<br />

<center><img src="images/VV_prop.png" width="800"/></center>

## Propri√©t√©s des variables visuelles

<br />

<center><img src="images/VV_categories.png" width="800"/></center>

## Des donn√©es aux variables visuelles

<br />

<center><img src="images/VV_donnee_carte.png" width="800"/></center>

## Des donn√©es aux variables visuelles

<br />

<center><img src="images/VV_arbre.png" width="720"/></center>

## Pour s'en convaincre...

::: columns
::: {.column width="50%"}
<img src="images/map_failed_1.jpg" width="350"/>
:::

::: {.column width="50%"}
:::
:::

## Pour s'en convaincre...

::: columns
::: {.column width="50%"}
<img src="images/map_failed_1.jpg" width="350"/>
:::

::: {.column width="50%"}
<img src="images/map_failed_2.jpg" width="350"/>
:::
:::

## Typer les donn√©es pour les repr√©senter

<center><img src="images/typer.png" width="700" class="bordered"/></center>

# Donn√©es qualitatives nominales

## Exprimer la diff√©renciation

::: columns
::: {.column width="50%"}
<img src="images/VV_couleur.png" width="450"/> <img src="images/VV_forme.png" width="450"/> <img src="images/VV_orientation.png" width="450"/> <img src="images/VV_texture_diff.png" width="450"/>
:::

::: {.column width="50%"}
:::
:::

## Exprimer la diff√©renciation

::: columns
::: {.column width="50%"}
<img src="images/VV_couleur.png" width="450"/> <img src="images/VV_forme.png" width="450"/> <img src="images/VV_orientation.png" width="450"/> <img src="images/VV_texture_diff.png" width="450"/>
:::

::: {.column width="50%"}
<img src="images/efficacite_differenciation.png" width="550"/>
:::
:::

##  {.hide background-color="white" background-image="images/map_couleur.jpg" background-size="contain"}

##  {.hide background-color="white" background-image="images/map_forme.png" background-size="contain"}

# Donn√©es quantit√©s absolues (stocks)

## Exprimer des quantit√©s

::: columns
::: {.column width="50%"}
<img src="images/VV_taille_ordre.png" width="550"/>
:::

::: {.column width="50%"}
<img src="images/quantite_surface.png" width="550"/>
:::
:::

##  {.hide background-color="white" background-image="images/map_taille_1.png" background-size="contain"}

::: footer
Source : Lib√©ration, 2015
:::

##  {.hide background-color="white" background-image="images/map_taille_2.png" background-size="contain"}

::: footer
Source : [Philippe Rekacewicz, 2014](https://visionscarto.net/l-arc-des-refugies), mis √† jour en 2017
:::

##  {.hide background-color="white" background-image="images/map_taille_3.png" background-size="contain"}

::: footer
**Les √©migrants du Globe** (Minard, 1862)
:::

##  {.hide background-color="white" background-image="images/map_taille_4.png" background-size="contain"}

::: footer
Fait avec Magrit ! Ce type de repr√©sentations n√©cessitent un travail important. De s√©lection tout d'abord (quel flux repr√©senter ?) et d'√©dition ensuite (√©viter le chevauchement des flux).
:::

##  {.hide background-color="white" background-image="images/map_taille_5.png" background-size="contain"}

::: footer
Source : Le [Grand Continent](https://legrandcontinent.eu/fr/2022/04/13/50-cartes-pour-lire-le-premier-tour-de-la-presidentielle-de-2022/), 2022
:::

##  {.hide background-color="white" background-image="images/map_taille_6.png" background-size="contain"}

::: footer
Cartogrammes non contigus, Judy Olson, novembre 1976
:::

# Donn√©es quantitatives relatives (ratios)

## Exprimer l'ordre

::: columns
::: {.column width="50%"}
<img src="images/VV_valeur.png" width="550"/> <img src="images/VV_harmonique.png" width="550"/> <img src="images/VV_intensite.png" width="550"/>
:::

::: {.column width="50%"}
<img src="images/VV_taille_ordre.png" width="550"/> <img src="images/VV_grain.png" width="550"/>
:::
:::

##  {.hide background-color="white" background-image="images/map_valeur_1.jpg" background-size="contain"}

::: footer
Carte figurative de l'instruction populaire de la France (1826), par Charles Dupin
:::


## Discr√©tisation des donn√©es

- La **discr√©tisation** est une √©tape importante dans la r√©alisation d'une carte th√©matique.
- Elle consiste √† **regrouper les donn√©es** en classes.
- Cela permet de **simplifier la carte** et de **rendre l'information plus lisible**.

## Avant de cartographier

-   L'information statistique contenue dans une table attributaire ne peut pas toujours √™tre cartographi√©e directement.\
    Pour √™tre intelligible, l'information doit souvent √™tre convertie, modifi√©e, r√©duite au pr√©alable.

-   Les donn√©es quantitatives relatives (taux, indices etc.) doivent *toujours* √™tre synth√©tis√©es et subdivis√©es en classes de valeurs.\
    Cette proc√©dure est souvent nomm√©e **discr√©tisation**.

# Les discr√©tisations {.inverse background-color="black"}

## Quelques principes

1.  Les classes doivent √™tre homog√®nes et distinctes les unes des autres.

2.  Le nombre de classes doit √™tre inf√©rieur au nombre d'observations.

3.  **Les caract√©ristiques essentielles de la distribution doivent √™tre pr√©serv√©es** (√©tendue, dispersion, forme de la distribution).

4.  Il est pr√©f√©rable d'utiliser des limites de classes arrondies ou pertinentes. Les bornes de classes doivent √™tre facile √† lire et √† m√©moriser.

## Comment proc√©der

### 1. R√©sumer la s√©rie statistique

-   Param√®tres de position ou valeurs centrales (moyenne, m√©diane, mode)\
    Ces param√®tres indiquent la valeur "typique" autour de laquelle les observations sont r√©parties.
-   Param√®tres de dispersion (√©cart-type, intervalle inter quartiles...)\
    Ces param√®tres mesurent de l'√©cart des valeurs d'une distribution √† une valeur centrale.

### 2. Analyser la forme de la distribution

-   Histogrammes, bo√Ætes √† moustaches, essaim d'abeilles (*beeswarm*)
-   ...

### 3. D√©terminer les intervales des classes

-   Il exise de nombreuses m√©thodes.

# Les m√©thodes de discr√©tisations {.inverse background-color="black"}

## Quelle dicr√©tisation choisir

![](images/Figure-2.08.png)

## Les m√©thodes

::: panel-tabset
### Les seuils naturels

![](images/Figure-2.09.png)

### Les amplitudes √©gales

![](images/Figure-2.10.png)

### Les effectifs √©gaux

![](images/Figure-2.11.png)

### Moyenne / √©cart-type

![](images/Figure-2.12.png)

### La progression g√©om√©trique

![](images/Figure-2.13.png)
:::

## Les m√©thodes

::: columns
::: {.column width="48%"}
::: medium
![](images/Figure-2.14.png)
:::
:::
:::

## Visualisation des discr√©tisations : une petite application p√©dagogique

::: columns
::: {.column width="68%"}
::: medium
[![](images/jeg.png)](https://mappemonde.gitpages.huma-num.fr/archives/119/)
:::
:::
:::

::: aside
Laurent J√©gou, ¬´ G√©ovisualisation des discr√©tisations : une petite application p√©dagogique ¬ª, *Mappemonde*, 119 \| 2017, <https://doi.org/10.4000/mappemonde.2569>
:::

## Les m√©thodes de discr√©tisation et leur utilisation dans Magrit

{{< video https://www.youtube.com/embed/7J5CCpGSGvA width="560" height="315" >}}

::: aside
Nicolas Lambert, 2020. COURS - Les m√©thodes de discr√©tisation et leur utilisation dans Magrit. <https://www.youtube.com/watch?v=7J5CCpGSGvA>
:::

## Habillage, mise en page et mise en sc√®ne de la carte

## Erreurs et pi√®ges √† √©viter

## Les composantes de l'information g√©ographique

<center>

<br>

```{r, echo = FALSE, out.width = "70%"}

library(DiagrammeR)

grViz("digraph dot {

  # a 'graph' statement
  graph [overlap = true]

  # several 'node' statements
  node [shape = rectangle, fontname = Helvetica, color='red', fontsize=9]
  d1

  node [shape = ellipse, fontname = Helvetica, color=black, fontsize = 6] // sets as circles
  d2; d3
  
  d1 [label = 'Donn√©es g√©ographiques'];
  d2 [label = 'G√©om√©tries'];
  d3 [label = 'Donn√©es'];

  # several 'edge' statements
  d1->d2[arrowhead = none]
  d1->d3[arrowhead = none]

}")
```

</center>


## G√©om√©tries

Elles d√©finissent la **forme** et la **localisation** de l'objet √† cartographier sur la surface terrestre.

La position des g√©om√©tries est toujours exprim√©e dans un syst√®me de coordonn√©es explicite : **coordonn√©es g√©ographiques** (latitude / longitude) ou **coordonn√©es projet√©es** (X / Y).

![](images/notre_dame.png)

## Vecteurs et rasters

2 types de donn√©es sont √† diff√©rencier : le raster et le vecteur. <br><br>

::: columns
::: {.column .medium width="49%"}

### Raster

C'est une **image** (plan scann√©, photographie a√©rienne, image satellitaire...) **localis√©e dans l'espace**.

L'information g√©ographique est alors stock√©e dans des cellules (pixel) contigu√´s g√©n√©ralement carr√©es.

Chaque pixel **d√©fini par une r√©solution** poss√®de des valeurs qui peuvent √™tre trait√©es et cartographi√©es.

Leur manipulation et analyse rel√®ve de champs m√©thodologiques particuliers (t√©l√©d√©tection). Les logiciels de cartographie th√©matique ne sont pas adapt√©s √† leur manipulation (\> SIG).
:::

::: {.column width="51%"}
![](images/raster.png)
:::
:::

## Vecteurs et rasters

2 types de donn√©es sont √† diff√©rencier : le raster et le vecteur. <br><br>

::: columns
::: {.column width="49%"}
### Vecteur

Il s'agit d'objets g√©om√©triques de type **points**, **lignes** ou **polygones**.

Ces objets vectoriels ne **pixelisent pas**. On parlera n√©anmoins de niveaux de g√©n√©ralisation pour qualifier leur niveau de pr√©cision (parfois aussi appel√©e r√©solution).

Chaque objet est d√©fini par **un identifiant unique**.
:::

::: {.column width="49%"}
![](images/vecteur.png)
:::
:::

## Vecteurs et rasters

2 types de donn√©es sont √† diff√©rencier : le raster et le vecteur. <br><br>

<center>![](images/raster_vecteur.png)</center>

## Formats de fichiers vectoriels

:::{.medium}

Les formats de stockage des g√©om√©tries les plus connus sont :

:::

<br />

::::{.columns .small}
::: {.column width="49%"}

-   **Shapefile (.shp)** : est le format de fichier **historique** des SIG. Initialement d√©velopp√© par ESRI pour ses logiciels commerciaux, il est devenu un standard *de facto*, malgr√© ses limitations (taille de fichiers, longueur texte, nombre maximal d'attributs)...

<br />

-   **Geographic JSON (.geojson)** : Un format ouvert d'encodage de donn√©es g√©ospatiales utilisant la norme JSON (JavaScript Object Notation), assez r√©pandu sur le Web (cartographie interactive).

<br />

-   **Geographic Markup Language (.gml)** : est un format de donn√©es g√©ographiques bas√© sur XML. Il permet d'√™tre tr√®s expressif (notamment via la possibilit√© de d√©finir des sch√©mas). Normalis√© par l'Open Geospatial Consortium (OGC) depuis 2000.
:::

::: {.column width="49%"}
-   **GeoPackage (.gpkg)** : Un format de donn√©es g√©ospatiales raster ou vecteur, ouvert, non li√© √† un syst√®me d'exploitation. Con√ßu pour √™tre aussi l√©ger que possible, il permet notamment de stocker plusieurs couches g√©ographiques dans un seul et m√™me fichier.

<br />

-   **Keyhole Markup Language (.kml)** : est fond√© sur le formalisme XML. Depuis 2008, le format est normalis√© par l'Open Geospatial Consortium. Il s'agit, avec le .gpx, du format classique de donn√©es produites par GPS.

<br />

-   **Fichiers tabulaires (.csv, .xls, etc.)** : tout simplement ! √Ä partir du moment o√π ils contiennent une dimension g√©ographique.

:::
::::

## Le shapefile

::::{.columns .medium}

Son extension est classiquement **.shp**, mais il est toujours accompagn√© de deux autres fichiers de m√™me nom :

::: {.column width="55%"}
-   **.dbf** : contient les donn√©es attributaires.
-   **.shx** : stocke l'index de la g√©om√©trie.

D'autres fichiers peuvent optionnellement √™tre √©galement fournis :

-   **.prj** : information sur le syst√®me de coordonn√©es.
-   **.cpg** : gestion de l'encodage.
-   *.shp.xml* : m√©tadonn√©es du shapefile.
-   *.sbn* et *.sbx*: index spatial des formes.
-   et potentiellement d'autres : .fbn,.fbx, .atx...

:::

::: {.column width="44%"}
<img src="images/shp.png" width="400"/>
:::
::::

:::{.medium}

> Il faut toujours conserver l'int√©grit√© de l'ensemble de ces fichiers et ne jamais √©diter un fichier en dehors de logiciels d√©di√©s.

:::


## Niveaux de g√©n√©ralisation

Le niveau de d√©tail relatif aux g√©ometries vectorielles (nombre de points).

Les fournisseurs de donn√©es g√©ographiques fournissent r√©guli√®rement plusieurs niveaux de g√©n√©ralisation, comme **Eurostat (GISCO)**.

::: panel-tabset
### 1:1 Million

```{r, echo = FALSE}
library(giscoR)
par(mar=c(0,0,0,0))
nuts2 <- gisco_get_nuts(nuts_level = 2, country = "France", resolution = "1")
bzh <- nuts2[nuts2$NUTS_ID == "FRH0",]
plot(bzh$geometry, col = NA, border = NA)
plot(nuts2, col = "peachpuff", border = "white", add = TRUE)
```

### 1:3 Million

```{r, echo = FALSE}
par(mar=c(0,0,0,0))
nuts2 <- gisco_get_nuts(nuts_level = 2, country = "France", resolution = "3")
plot(bzh$geometry, col = NA, border = NA)
plot(nuts2, col = "peachpuff", border = "white", add = TRUE)
```

### 1:10 Million

```{r, echo = FALSE}
par(mar=c(0,0,0,0))
nuts2 <- gisco_get_nuts(nuts_level = 2, country = "France", resolution = "10")
plot(bzh$geometry, col = NA, border = NA)
plot(nuts2, col = "peachpuff", border = "white", add = TRUE)
```

### 1:20 Million

```{r, echo = FALSE}
par(mar=c(0,0,0,0))
nuts2 <- gisco_get_nuts(nuts_level = 2, country = "France", resolution = "20")
plot(bzh$geometry, col = NA, border = NA)
plot(nuts2, col = "peachpuff", border = "white", add = TRUE)
```

### 1:60 Million

```{r, echo = FALSE}
par(mar=c(0,0,0,0))
nuts2 <- gisco_get_nuts(nuts_level = 2, country = "France", resolution = "60")
plot(bzh$geometry, col = NA, border = NA)
plot(nuts2, col = "peachpuff", border = "white", add = TRUE)
```
:::

## Niveaux de g√©n√©ralisation

Le niveau de d√©tail relatif aux g√©ometries vectorielles (nombre de points).

Les fournisseurs de donn√©es g√©ographiques fournissent r√©guli√®rement plusieurs niveaux de g√©n√©ralisation, comme **Eurostat (GISCO)** ou **Natural Earth**.

::: panel-tabset
### 10 (large)

```{r, echo = FALSE, warning=FALSE, message = FALSE, include = FALSE}
library(rnaturalearth)
library(sf)
country_large <- ne_download(scale = "large", returnclass = "sf")
country_medium <- ne_download(scale = "medium", returnclass = "sf")
country_small <- ne_download(scale = "small", returnclass = "sf")
```

```{r, echo = FALSE, warning=FALSE, message = FALSE}
par(mar=c(0,0,0,0))
fra <- country_large[country_large$ADM0_A3 == "FRA",]
fra <- st_cast(fra, "POLYGON")
plot(fra[c(2,12),"geometry"], col = NA, border = NA)
plot(country_large, col = "peachpuff", border = "white", add = TRUE)
```

### 50 (medium)

```{r, echo = FALSE, warning=FALSE, message = FALSE}
par(mar=c(0,0,0,0))
plot(fra[c(2,12),"geometry"], col = NA, border = NA)
plot(country_medium, col = "peachpuff", border = "white", add = TRUE)
```

### 110 (small)

```{r, echo = FALSE, warning=FALSE, message = FALSE}
par(mar=c(0,0,0,0))
plot(fra[c(2,12),"geometry"], col = NA, border = NA)
plot(country_small, col = "peachpuff", border = "white", add = TRUE)
```
:::

## Niveaux de g√©n√©ralisation

Le choix du niveau de g√©n√©ralisation adapt√© d√©pend des **objectifs de la carte**, de l'emprise de **espace d'√©tude**, et des **caract√©ristiques des polygones du fond de carte**.

```{r, echo = FALSE}
library(mapsf)
library(sf)
par(mar=c(0,0,0,0))
nuts2 <- gisco_get_nuts(nuts_level = 3, resolution = "1", epsg = "3035")
nuts0 <- gisco_get_nuts(nuts_level = 0, resolution = "1", epsg = "3035")
xmin <- 2380000
xmax <- 6550000
ymin <- 1350000
ymax <- 5420000

lon <- c(xmin,xmax,xmax,xmin,xmin)
lat <- c(ymin,ymin,ymax,ymax,ymin)
frame <- st_sfc(st_polygon(list(cbind(lon, lat))))
frame <- st_as_sf(frame)
st_crs(frame) <- 3035

map_theme <- mf_theme("default", bg = NA, fg = NA, mar = c(0, 0, 0, 0), tab = TRUE,
                      pos = "left",  inner = TRUE, line = 3, cex = .8, font = 2)
mf_theme(map_theme)
mf_init(frame)
mf_map(nuts2, var = "URBN_TYPE", type = "typo", pal = c("red", "yellow", "lightgreen"), 
  val_order = c("1", "2", "3"), border = "white", lwd = .7, add = TRUE, leg_pos = "n")
mf_legend(type = "typo", pos = "left", title = "Typologie Urbain-Rural",
          val = c("R√©gion √† pr√©dominance urbaine", "Region interm√©diaire", 
                  "R√©gion √† pr√©dominance rurale"),
          pal = c("red", "yellow", "lightgreen"))
mf_map(nuts0, col = NA, border = "black", add = TRUE)
mf_title("Niveau de g√©n√©ralisation : 1:1 Million", inner = TRUE)
mf_credits(txt = "Source : GISCO, Eurostat, 2023")
```

## Niveaux de g√©n√©ralisation

Le choix du niveau de g√©n√©ralisation adapt√© d√©pend des **objectifs de la carte**, de l'emprise de **espace d'√©tude**, et des **caract√©ristiques des polygones du fond de carte**.

```{r, echo = FALSE}
library(mapsf)
library(sf)
par(mar=c(0,0,0,0))
nuts2 <- gisco_get_nuts(nuts_level = 3, resolution = "60", epsg = "3035")
nuts0 <- gisco_get_nuts(nuts_level = 0, resolution = "60", epsg = "3035")

mf_theme(map_theme)
mf_init(frame)
mf_map(nuts2, var = "URBN_TYPE", type = "typo", pal = c("red", "yellow", "lightgreen"), 
  val_order = c("1", "2", "3"), border = "white", lwd = .7, add = TRUE, leg_pos = "n")
mf_legend(type = "typo", pos = "left", title = "Typologie Urbain-Rural",
          val = c("R√©gion √† pr√©dominance urbaine", "Region interm√©diaire", 
                  "R√©gion √† pr√©dominance rurale"),
          pal = c("red", "yellow", "lightgreen"))
mf_map(nuts0, col = NA, border = "black", add = TRUE)
mf_title("Niveau de g√©n√©ralisation : 1:60 Million", inner = TRUE)
mf_credits(txt = "Source : GISCO, Eurostat, 2023")
```

## Simplifier les g√©om√©tries

Des outils existent pour simplifier le niveau de d√©tail des g√©om√©tries, comme [Mapshapper](https://mapshaper.org/)

::: columns
::: {.column width="49%"}
![](images/mapshapper.png)
:::

::: {.column width="49%"}
![](images/mapshapper2.png)
:::
:::

## Rechercher de l'information g√©ographique

Les fournisseurs de fonds de carte g√©or√©f√©renc√©s sont nombreux...

:::{.medium}

**Au niveau international**

-   <a href="https://gadm.org/" target="_blank">Global Administrative Boundaries (GADM)</a>
-   <a href="https://www.naturalearthdata.com/" target="_blank">Natural Earth</a>
-   <a href="https://land.copernicus.eu/" target="_blank">Copernicus</a>
-   <a href="https://www.worldpop.org/" target="_blank">World Pop</a>
-   <a href="https://ec.europa.eu/eurostat/web/gisco/geodata/reference-data" target="_blank">Eurostat - GISCO</a>
-   <a href="https://www.openstreetmap.fr/" target="_blank">OpenSreetMap (OSM)</a>, donn√©es exportables via des API comme <a href="http://overpass-turbo.eu/" target="_blank">Overpass-turbo</a>

:::

## Donn√©es attributaires

L'ensemble des informations relatives √† un objet g√©ographique, qui le d√©crivent et le caract√©risent.

```{r, echo = FALSE, out.width = "800px", fig.align='center'}
knitr::include_graphics('images/attribut.png')
```

## Pourquoi faire ?

Les g√©om√©tries contiennent souvent quelques attributs statistiques, **assez limit√©s** pour initier des analyses ou produire des repr√©sentations cartographiques.

::: columns
::: {.column width="49%"}
::: medium
Attributs associ√©s aux g√©om√©tries des communes fran√ßaises (IGN)
:::

```{r, echo = FALSE, out.width = "800px", fig.align='center'}
com <- read.csv("data/insee_extract.csv")
head(com, 5)
```
:::

::: {.column width="49%"}
::: medium
<center>Attributs associ√©s aux g√©om√©tries des r√©gions europ√©ennes (GISCO)</center>
:::

```{r, echo = FALSE, out.width = "800px", fig.align='center'}
library(giscoR)
nuts2 <- gisco_get_nuts(nuts_level = 2, country = "FR", resolution = "60", epsg = "3035")
nuts2 <- st_set_geometry(nuts2, NULL)
head(nuts2)
```
:::
:::


## Dimension g√©ographique de tableaux de donn√©es statistiques

::::{.columns .medium}
::: {.column width="49%"}
On parle ici de tableaux de donn√©es d√©finis par :

-   Une emprise g√©ographique (France, Europe, Monde, etc.)
-   Une brique g√©ographique √©l√©mentaire (une commune, une rivi√®re, une r√©gion, une for√™t, etc.)
-   Des donn√©es attributaires utiles √† l'analyse.
-   Un identifiant unique pour chaque brique g√©ographique √©l√©mentaire.
-   Une correspondance au moins partielle avec le fond de carte dont on dispose.

:::

::: {.column width="49%"}
![](images/Excel_tab.png)
:::

> On peut alors enrichir s√©mantiquement les g√©om√©tries !

::::

## Comment faire ?

Dans les cas relevant de la donn√©e institutionnelle c'est plut√¥t facile ! Les codes g√©ographiques (uniques) des unit√©s territoriales qui composent les fonds de carte sont norm√©s et une association √©troite entre fond de carte.

::::{.columns .medium}
::: {.column width="49%"}

On peut citer par exemple :

-   √Ä l'**√©chelle mondiale** : Natural Earth (g√©om√©tries) / Nations Unies (Population prospect) : pays d√©finis par des codes ISO uniques.
-   √Ä l'**√©chelle europ√©enne** : GISCO (g√©om√©tries) / Eurostat (donn√©es socio-√©conomiques). R√©gions europ√©ennes d√©finies par la nomenclature **NUTS**.
-   √Ä l'**√©chelle fran√ßaise** : IGN (g√©om√©tries) / INSEE. Plusieurs d√©coupages disponibles (communes, EPCI, etc.)

Il faut juste veiller √† la **compatibilit√© de version des donn√©es et g√©om√©tries**

:::

::: {.column width="49%"}

Donn√©es de population communales de l'INSEE ![](images/insee.png)

:::

::::

## Comment faire ?

:::{.medium}
Dans les cas relevant de la donn√©e institutionnelle c'est plut√¥t facile ! Les codes g√©ographiques (uniques) des unit√©s territoriales qui composent les fonds de carte sont norm√©s et une association √©troite entre fond de carte.
:::

::::{.columns .medium}
::: {.column width="49%"}
On peut citer par exemple :

-   √Ä l'**√©chelle mondiale** : Natural Earth (g√©om√©tries) / Nations Unies (Population prospect) : pays d√©finis par des codes ISO uniques.
-   √Ä l'**√©chelle europ√©enne** : GISCO (g√©om√©tries) / Eurostat (donn√©es socio-√©conomiques). R√©gions europ√©ennes d√©finies par la nomenclature **NUTS**.
-   √Ä l'**√©chelle fran√ßaise** : IGN (g√©om√©tries) / INSEE. Plusieurs d√©coupages disponibles (communes, EPCI, etc.)

Il faut juste veiller √† la **compatibilit√© de version des donn√©es et g√©om√©tries**
:::

::: {.column width="49%"}
Donn√©es de population communales de l'INSEE ![](images/ign.png)
:::

::::

## Comment faire ?

Pour les fonds de carte "moins conventionnels", utiliser les fonctionnalit√©s des SIG ou des logiciels de cartographie th√©matique pour exporter les codes associ√©s et g√©rer la bonne concordance entre les donn√©es que vous collectez et les fonds de carte de r√©f√©rence.

![](images/export_csv.png)

## Comment faire ?

::::{.columns .medium}
::: {.column width="49%"}

L'enrichissement de donn√©es attributaires au format tabulaire (.csv, .xls, .ods, etc.) est r√©alis√© par une **jointure attributaire**.

Elle d'**associer deux tables attributaires d√©crivant des entit√©s communes**. L'op√©ration produit une seule table juxtaposant les champs de la table √† joindre √† ceux de la table d'origine.

Avec les logiciels de cartographie / SIG, la table d'origine est souvent associ√©e aux g√©om√©tries.

Les jointures attributaires sont utilis√©es pour introduire des informations nouvelles dans une couche g√©ographique.

:::

::: {.column width="49%"}

![](images/jointure_attributaire.png)

Source : Universit√© Virtuelle Environnement et D√©veloppement durable, glossaire des SIG

:::
::::

## Comment faire ?

La jointure attributaire est une fonctionnalit√© de base des logiciels de cartographie th√©matique ou de SIG.

::: columns
::: {.column width="49%"}
![](images/join_1.png)
:::

::: {.column width="49%"}
![](images/join_2.png)
:::
:::


## Pour conclure sur l'information g√©ographique

<br>

**Questions centrales √† se poser** lorsque l'on recherche de l'information g√©ographique :

-   **Quel est mon espace d'√©tude ?** *Monde ? Europe ? France ? Ile-de-France ? ...*<br>

-   **Quel est l'objet g√©ographique sur lequel je travaille ?** *Pays ? R√©gions ? Communes ? Parcs naturels ? Rivi√®res ? ...* <br>

-   **Quelle est la th√©matique que je souhaite explorer ?** *Environnement ? D√©mographie ? Transport? ...* <br>

-   **Quel est le format de donn√©es que je recherche ?** *G√©om√©tries ? Donn√©es statistiques √† joindre √† mes couches g√©ographiques ?* <br>

-   **Donn√©es institutionnelles ? Quelle p√©riode ?**

# Pr√©sentation de l'application Magrit

## Un outil complet

<center>

![](images/magrit-complete-tool.png){.w700}

</center>

## Diff√©rents types de repr√©sentations cartographiques

<center>
<img src="images/Magrit-red-black-description.png" class="w900">
</center>

## Des repr√©sentations cartographiques classiques

## Des repr√©sentations cartographiques combin√©es

## Des repr√©sentations cartographiques "avanc√©es"

## Des repr√©sentations cartographiques "avanc√©es"

## Un logiciel libre et gratuit

Le projet Magrit a d√©marr√© courant 2016. C'est un projet libre, sous licence CeCILL (une licence compatible avec la licence GPL).

![](images/cecill.png){.w300}

Le code source est disponible sur GitHub : [https://github.com/riatelab/magrit](https://github.com/riatelab/magrit).

![](images/github-screenshot.png){.w600}


## Une application Web

Magrit est une application Web, c'est √† dire qu'elle fonctionne **directement dans un navigateur Web** et donc avec n'importe quel syst√®me d'exploitation (Windows, MacOS, Linux, ...).

<center>
![](images/ui-and-browser-screenshot.png){.w700}
</center>

## Une application multilingue

<br />

Magrit est disponible en **fran√ßais**, **anglais** et **espagnol** (Am√©rique latine).

<br />
<center>
![](images/magrit-multilang.png){.w300 .bordered}
</center>

## De nombreux formats de donn√©es support√©s en entr√©e

<br />

::::{.columns .medium}

:::{.column width=50%}

Magrit permet d'importer des **donn√©es g√©ographiques** dans de nombreux formats :

- **GeoJSON**
- **TopoJSON**
- **Shapefile**
- **GML**
- **KML**
- **GeoPackage**

:::

:::{.column width=50%}

Magrit permet √©galement d'importer des **donn√©es tabulaires** (qui pourront √™tre jointes √† des donn√©es g√©ographiques) :

- **CSV** / **TSV**
- **XLS** et **XLSX**
- **ODS**

:::
::::

## Diff√©rents types d'exports disponibles

<br />

Magrit permet d'exporter les cartes r√©alis√©es dans diff√©rents formats :

- **PNG** (par ex. pour une utilisation directe dans un rapport ou une pr√©sentation)
- **SVG** (par ex. pour permettre une √©dition ult√©rieure dans un logiciel de dessin vectoriel comme InkScape ou Adobe Illustrator)

<center>
<img src="images/ExportModifInkscape.png" class="w500">
</center>

## Diff√©rents types d'exports disponibles

<br />

:::{.medium}

Il est √©galement possible d'exporter les couches pr√©sentes dans la carte dans diff√©rents formats :

- **GeoJSON**
- **TopoJSON**
- **Shapefile**
- **GML**
- **KML**
- **CSV** (seulement les donn√©es attributaires)

<br />
üí° Utile par exemple pour r√©utiliser les couches issues de certaines modes de repr√©sentation (lissage, discontinuit√©s, cartogrammes, etc.) dans un SIG.

:::

## Utilis√©e pour l'apprentissage de la cartographie th√©matique √† l'universit√©

<br /><br />

<center>

![](images/logo_univ.png){.w900}

</center>


## Autour de Magrit...

- Magrit dispose d'une documentation compl√®te en fran√ßais : [https://magrit.cnrs.fr/docs/](https://magrit.cnrs.fr/docs/).

![](images/documentation-screenshot.png){.absolute .bordered top=200 left=200 width="780" height="609"}

## Autour de Magrit...

- Des supports de formations (comprenant slides de cours et exercices), pr√©par√©s par l'UAR RIATE, sont mis √† disposition sous licence CC-BY-SA : [https://github.com/magrit-formations](https://github.com/magrit-formations).

::::{.columns .medium}

:::{.column width=50%}

![](images/formation-screenshot-repository.png){.w400}

:::

:::{.column width=50%}

![](images/formation-screenshot.png)

[&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Exemple de support de formation ‚§¥]{.center .small}

[‚¨Ö Page d'accueil du d√©p√¥t des supports de formation]{.center .small}

:::

::::

## Autour de Magrit...

# Exemple d'utilisation de Magrit <br /> - <br /> D√©monstration

## D√©monstration

<br />

*Cette d√©monstration vise √† pr√©senter les principales fonctionnalit√©s de Magrit, de la r√©alisation rapide d'une carte simple
jusqu'√† la r√©alisation d'une carte plus complexe, √† la mise en page soign√©e.*

<br />

<center>

**üñ•Ô∏è [https://magrit.cnrs.fr/](https://magrit.cnrs.fr/)**  
**üïú Environ 35 minutes**

</center>

:::{.medium}

<br />

**Donn√©es utilis√©es¬†:**

- D√©partements et r√©gions du S√©n√©gal ([https://www.africageoportal.com/](https://www.africageoportal.com/))
- Donn√©es de population (RGPHAE 2013)

:::

:::{.notes}

D√©roul√© de la d√©monstration : 

- Import des donn√©es d√©partements
- Import des donn√©es r√©gions
- Insister sur la diff√©rence "fond de carte principal" et "fonds de carte d'habillage" /!\
- Importer jeu de donn√©es Afrique...
- Import du jeu de donn√©es CSV pour la population des d√©partements
- Jointure
- Repr√©sentation Symboles proportionnels
- Cr√©ation de labels...
- Ajout colonne densit√© population
- Repr√©sentation choropl√®the
- Repr√©sentation symboles proportionnels + choropl√®the
- Repr√©sentation lissage
- Repr√©sentation cartogramme
- .... + choropl√®the sur le cartogramme
- Ajout de couche de labels en modifiant la localisation des labels

- Ajout fond de carte Monde pour habillage ...
- Pr√©parer habillage (titre, l√©gende en la personnalisant, etc., contour autour du texte du titre, ajout texte avec source des donn√©es, ajout logo, etc.)
- Export PNG
- Export SVG
- Export donn√©es


:::


# Exercices pratiques / discussion

## Exercice pratique

## Perspectives de d√©veloppement

- Un logiciel en d√©veloppement actif...



## Discussion / conclusion

## Bibliographie indicative

<br />

::::{.columns .medium .center}

:::{.column width=48%}

LAMBERT Nicolas, ZANIN Christine.<br />**Manuel de cartographie. Principes, m√©thodes, applications**.<br />Armand Colin, 2016.

<img src="images/LZ.jpeg" class="bordered" style="width: 60%"/>

:::

:::{.column width=48%}

BEGUIN Mich√®le, PUMAIN Denise.<br />**La repr√©sentation des donn√©es g√©ographiques. Statistique et cartographie**.<br />4√®me √©dition. Armand Colin, 2014.

<img src="images/BP.jpg" class="bordered" style="width: 60%"/>

:::

::::

# Merci de votre attention ! üôè

<br />

**Magrit** : [https://magrit.cnrs.fr/](https://magrit.cnrs.fr/)

**D√©p√¥t GitHub** : [https://github.com/riatelab/magrit](https://github.com/riatelab/magrit)

**Documentation** : [https://magrit.cnrs.fr/docs/](https://magrit.cnrs.fr/docs/)

**Supports de formation** : [https://github.com/magrit-formations](https://github.com/magrit-formations)

<br />

**Contact** : [matthieu.viry@cnrs.fr](mailto:matthieu.viry@cnrs.fr)